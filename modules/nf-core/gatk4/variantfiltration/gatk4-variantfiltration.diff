Changes in module 'nf-core/gatk4/variantfiltration'
'modules/nf-core/gatk4/variantfiltration/meta.yml' is unchanged
'modules/nf-core/gatk4/variantfiltration/environment.yml' is unchanged
Changes in 'gatk4/variantfiltration/main.nf':
--- modules/nf-core/gatk4/variantfiltration/main.nf
+++ modules/nf-core/gatk4/variantfiltration/main.nf
@@ -8,7 +8,7 @@
         : 'community.wave.seqera.io/library/gatk4_gcnvkernel:edb12e4f0bf02cd3'}"
 
     input:
-    tuple val(meta), path(vcf), path(tbi)
+    tuple val(meta), path(vcf), path(tbi), val(filters)
     tuple val(meta2), path(fasta)
     tuple val(meta3), path(fai)
     tuple val(meta4), path(dict)
@@ -33,6 +33,14 @@
     }
     dict_name = "${dict_name}.dict"
 
+    // Custom filters in Map[filter_name]=filter_expr
+    def filters_command = ""
+    if (filters) {
+        filters_command = filters.collect { name, expr ->
+          "--filter-name '${name}' --filter-expression '${expr}'"
+        }.join(' ')
+    }
+
     def avail_mem = 3072
     if (!task.memory) {
         log.info('[GATK VariantFiltration] Available memory not known - defaulting to 3GB. Specify process memory requirements to change this.')
@@ -52,6 +60,7 @@
         --output ${prefix}.vcf.gz \\
         --reference ${fasta} \\
         --tmp-dir . \\
+        ${filters_command} \\
         ${args}
 
     cat <<-END_VERSIONS > versions.yml

'modules/nf-core/gatk4/variantfiltration/tests/main.nf.test.snap' is unchanged
Changes in 'gatk4/variantfiltration/tests/main.nf.test':
--- modules/nf-core/gatk4/variantfiltration/tests/main.nf.test
+++ modules/nf-core/gatk4/variantfiltration/tests/main.nf.test
@@ -17,7 +17,8 @@
                 input[0] = [
                     [ id:'test' ], // meta map
                     file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf', checkIfExists: true),
-                    file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.idx', checkIfExists: true)
+                    file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.idx', checkIfExists: true),
+                    [:]
                 ]
                 input[1] = [
                     [ id:'genome' ], // meta map
@@ -58,7 +59,8 @@
                 input[0] = [
                     [ id:'test' ], // meta map
                     file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf', checkIfExists: true),
-                    file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.idx', checkIfExists: true)
+                    file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.idx', checkIfExists: true),
+                    [:]
                 ]
                 input[1] = [
                     [ id:'genome' ], // meta map
@@ -99,7 +101,8 @@
                 input[0] = [
                     [ id:'test' ], // meta map
                     file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.gz', checkIfExists: true),
-                    file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.gz.tbi', checkIfExists: true)
+                    file(params.modules_testdata_base_path + 'genomics/homo_sapiens/illumina/gvcf/test.genome.vcf.gz.tbi', checkIfExists: true),
+                    [:]
                 ]
                 input[1] = [
                     [ id:'genome' ], // meta map

************************************************************
